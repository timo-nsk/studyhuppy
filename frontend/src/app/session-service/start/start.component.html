<div class="main-container d-flex flex-column align-items-center">
  <div class="d-flex flex-column align-items-center">
    <div class="pre-session-container" *ngIf="sessions == null">
      <p>Sie haben noch keine Lern-Sessions erstellt.</p>
      <p>Erstellen sie <a [routerLink]="'/module/session/create'">hier</a> eine Lern-Session!</p>
    </div>

    <div *ngIf="sessions != null">
      <div class="pre-session-container" *ngIf="sessions.length > 0">
        <p>Session-Konfiguration auswÃ¤hlen</p>
        <select class="form-select" [disabled]="sessionSelectIsDisabled">
          <option *ngFor="let session of sessions"
                  (click)="selectSession(session)">
            {{session.titel}} ({{getComputedSessionZeit(session) | timeFormat}})
          </option>
        </select>
      </div>

      <div class="block-wrapper">
        <div class="block-container" *ngFor="let block of selectedSession?.blocks" [ngClass]="{ 'active-block': block.fachId == getCurrentBlockId() && !sessionStarted }">
          <div *ngIf="block.fachId == getCurrentBlockId()">
            <table>
              <tbody>
              <tr>
                <td class="td-label">Modul:</td>
                <td>{{block.modulName}}</td>
              </tr>
              <tr>
                <td class="td-label">Lernzeit:</td>
                <td>{{getCurrentLernzeit() | timeFormat}}</td>
              </tr>
              <tr>
                <td class="td-label">Pause:</td>
                <td>{{getCurrentPause() | timeFormat}}</td>
              </tr>
              </tbody>
            </table>
          </div>
          <div *ngIf="block.fachId != getCurrentBlockId()">
            <table>
              <tbody>
              <tr>
                <td class="td-label">Modul:</td>
                <td>{{block.modulName}}</td>
              </tr>
              <tr>
                <td class="td-label">Lernzeit:</td>
                <td>{{block.lernzeitSeconds | timeFormat}}</td>
              </tr>
              <tr>
                <td class="td-label">Pause:</td>
                <td>{{block.pausezeitSeconds | timeFormat}}</td>
              </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="d-flex flex-column align-items-center">
          <button class="sh-btn" *ngIf="sessionStarted" (click)="startSession()">Session starten</button>
        </div>
        <div class="d-flex flex-row align-content-center justify-content-center">
          <button id="session-pause-btn" class="sh-btn" *ngIf="!sessionStarted && !sessionPaused" (click)="pauseSession()">Session pausieren</button>
          <button id="session-resume-btn" class="sh-btn" *ngIf="!sessionStarted && sessionPaused" (click)="resumeSession()">Session fortsetzen</button>
          <button id="session-abort-btn" class="sh-btn" *ngIf="!sessionStarted" (click)="abortThisSession()">Session abbrechen</button>
          <button id="session-skip-btn" class="sh-btn" *ngIf="!sessionStarted" (click)="skipLernblock()">Block Ã¼berspringen</button>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="rating-modal" tabindex="-1" aria-labelledby="rating-modal-label" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="rating-modal-label">Lernsession beendet ðŸŽ‰</h5>
              </div>
              <div class="modal-body">
                <div>
                  <p>Wie ist die Lernsession gelaufen?</p>
                </div>
                <section class="rating-section bordered">
                  <div class="rating-container bordered">
                    <table class="bordered">
                      <tbody>
                      <tr>
                        <td class="td-label">Konzentration</td>
                        <td class="td-rating">
                          <rating [(ngModel)]="sessionBewertung.konzentrationBewertung" [max]="10"></rating>
                        </td>
                      </tr>
                      <tr>
                        <td class="td-label">ProduktivitÃ¤t</td>
                        <td class="td-rating">
                          <rating [(ngModel)]="sessionBewertung.produktivitaetBewertung" [max]="10"></rating>
                        </td>
                      </tr>
                      <tr>
                        <td class="td-label">Schwierigkeit</td>
                        <td class="td-rating">
                          <rating [(ngModel)]="sessionBewertung.schwierigkeitBewertung" [max]="10"></rating>
                        </td>
                      </tr>
                      </tbody>
                    </table>
                  </div>
                </section>
              </div>

              <div class="modal-footer">
                <button id="skip-rate-btn" type="button" class="rate-btn" data-bs-dismiss="modal">skip</button>
                <button id="send-rate-btn" type="button" class="rate-btn" data-bs-dismiss="modal" (click)="sendBewertung()">bewerten</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

